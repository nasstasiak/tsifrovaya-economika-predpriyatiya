!function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.lightbox=e()}(this,(function(){"use strict";var t,e,n,o,i,a,r,s,l,c,u,d='<svg width="44" height="60"><polyline points="30 10 10 30 30 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',f='<svg width="44" height="60"><polyline points="14 10 34 30 14 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',g='<svg width="30" height="30"><g stroke="rgb(160,160,160)" stroke-width="4"><line x1="5" y1="5" x2="25" y2="25"/><line x1="5" y1="25" x2="25" y2="5"/></g></svg>',m={},h={captions:!0,buttons:"auto",fullScreen:!1,noScrollbars:!1,bodyClass:"lightbox-open",titleTag:!1,async:!1,preload:2,animation:"slideIn",afterShow:null,afterHide:null,onChange:null,overlayBackgroundColor:"rgba(0,0,0,.8)",sens:100},b=window.innerWidth*window.devicePixelRatio,p={},v=[],y=0,w=!1,k={},x=!1,C=/.+\.(gif|jpe?g|png|webp)/i,E={},T=[],N=null;s=null,void 0!==(l=window.document.documentElement.style)["-webkit-border-image"]?s="webkit":void 0!==l["-moz-border-image"]?s="moz":void 0!==l["-ms-border-image"]?s="ms":void 0!==l.OBorderImage&&(s="o"),r=(c=s)?"-"+c+"-transform":"transform",p.transforms=void 0!==document.documentElement.style.perspective,p.svg=((u=_("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(u.firstChild&&u.firstChild.namespaceURI)),p.passiveEvents=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}();var L=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,U()},A=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,D()},B=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,R()},S=function(t){if(0===t.target.id.indexOf("lightbox-img"))return R();k.count++,k.count>1&&(k.multitouch=!0),k.startX=k.prevX=t.changedTouches[0].pageX,k.startY=k.prevY=t.changedTouches[0].pageY},X=function(t){if(t.preventDefault(),0===t.target.id.indexOf("lightbox-img"))return R();x=!0,k.startX=t.pageX,this.style.cursor="-webkit-grabbing"},P=function(t){x=!1,this.style.cursor="-webkit-grab";var e=t.pageX-k.startX;Math.abs(e)<=40?a%100!=0&&V(y):V(e>0?y-1:y+1)},F=function(n){var o;switch(n.type){case"touchmove":if(x||k.multitouch)return;o=n.touches[0]||n.changedTouches[0];break;case"mousemove":if(!x)return;o=n}var i=t.getBoundingClientRect().width;if("slideIn"===m.animation){var s=(o.pageX-k.prevX)*m.sens/i;a+=s,e.style[r]="translate3d("+a+"%, 0, 0)"}k.prevX=o.pageX,k.prevY=o.pageY},H=function(t){k.count--,k.count<=0&&(k.multitouch=!1),x=!1;var e=t.touches[0]||t.changedTouches[0];this.style.cursor="-webkit-grab";var n=e.pageX-k.startX;Math.abs(n)<=40?a%100!=0&&V(y):V(n>0?y-1:y+1)},I=function(){H()},Y=function(e){"block"===t.style.display&&t.contains&&!t.contains(e.target)&&(e.stopPropagation(),initFocus())};function j(t){if(E.hasOwnProperty(t)){var e=E[t].galleries;[].forEach.call(e,(function(t){[].forEach.call(t,(function(t){Z(t.imageElement,"click",t.eventHandler)})),v===t&&(v=[])})),delete E[t]}}function q(t){switch(t.keyCode){case 37:U();break;case 39:D();break;case 27:R()}}function M(i,a){if(v!==i){for(v=i,function(i){i||(i={});for(var a in h)m[a]=h[a],void 0!==i[a]&&(m[a]=i[a]);e.style.transition=e.style[r]="fadeIn"===m.animation?"opacity .4s ease":"slideIn"===m.animation?"":"none","auto"!==m.buttons||!("ontouchstart"in window)&&1!==v.length||(m.buttons=!1);n.style.display=o.style.display=m.buttons?"":"none";try{t.style.backgroundColor=m.overlayBackgroundColor}catch(t){}}(a);e.firstChild;)e.removeChild(e.firstChild);T.length=0;for(var s,l=[],c=[],u=0;u<i.length;u++)(s=_("div")).className="full-image",s.id="lightbox-img-"+u,T.push(s),l.push("lightbox-figure-"+u),c.push("lightbox-figcaption-"+u),e.appendChild(T[u]);t.setAttribute("aria-labelledby",l.join(" ")),t.setAttribute("aria-describedby",c.join(" "))}}function O(e){m.noScrollbars&&(document.documentElement.style.overflowY="hidden",document.body.style.overflowY="scroll"),"block"!==t.style.display&&(Q(document,"keydown",q),k={count:0,startX:null,startY:null},z(y=e,(function(){J(y),K(y)})),G(),t.style.display="block",m.fullScreen&&(t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen&&t.mozRequestFullScreen()),setTimeout((function(){t.className="visible",m.bodyClass&&document.body.classList&&document.body.classList.add(m.bodyClass),m.afterShow&&m.afterShow()}),50),m.onChange&&m.onChange(y,T.length),N=document.activeElement,i.focus(),w=!0)}function R(){m.noScrollbars&&(document.documentElement.style.overflowY="auto",document.body.style.overflowY="auto"),"none"!==t.style.display&&(Z(document,"keydown",q),t.className="",setTimeout((function(){t.style.display="none",document.exitFullscreen||(document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),m.bodyClass&&document.body.classList&&document.body.classList.remove(m.bodyClass),m.afterHide&&m.afterHide(),N&&N.focus(),w=!1}),500))}function z(t,e){var n=T[t],o=v[t];if(void 0!==n&&void 0!==o)if(n.getElementsByTagName("img")[0])e&&e();else{var i=o.imageElement,a=i.getElementsByTagName("img")[0],r="function"==typeof m.captions?m.captions.call(v,i):i.getAttribute("data-caption")||i.title,s=function(t){var e=t.href;if(t.dataset){var n=[];for(var o in t.dataset)"at-"!==o.substring(0,3)||isNaN(o.substring(3))||(n[o.replace("at-","")]=t.dataset[o]);for(var i=Object.keys(n).sort((function(t,e){return parseInt(t,10)<parseInt(e,10)?-1:1})),a=0;a<i.length-1&&i[a]<b;)a++;e=n[i[a]]||e}return e}(i),l=_("figure");if(l.id="lightbox-figure-"+t,l.innerHTML='<div class="lightbox-spinner"><div class="lightbox-double-bounce1"></div><div class="lightbox-double-bounce2"></div></div>',m.captions&&r){var c=_("figcaption");c.id="lightbox-figcaption-"+t,c.innerHTML=r,l.appendChild(c)}n.appendChild(l);var u=_("img");u.onload=function(){var n=document.querySelector("#lightbox-img-"+t+" .lightbox-spinner");l.removeChild(n),!m.async&&e&&e()},u.setAttribute("src",s),u.alt=a&&a.alt||"",m.titleTag&&r&&(u.title=r),l.appendChild(u),m.async&&e&&e()}}function D(){return V(y+1)}function U(){return V(y-1)}function V(t,e){return!w&&t>=0&&t<e.length?(M(e,m),O(t),!0):t<0?(m.animation&&W("left"),V(y),!1):t>=T.length?(m.animation&&W("right"),V(y),!1):(z(y=t,(function(){J(y),K(y)})),G(),m.onChange&&m.onChange(y,T.length),!0)}function W(t){e.className="bounce-from-"+t,setTimeout((function(){e.className=""}),400)}function G(){a=100*-y,"fadeIn"===m.animation?(e.style.opacity=0,setTimeout((function(){p.transforms?e.style.transform=e.style[r]="translate3d("+a+"%,0,0)":e.style.left=a+"%",e.style.opacity=1}),400)):p.transforms?e.style.transform=e.style[r]="translate3d("+a+"%,0,0)":e.style.left=a+"%"}function J(t){t-y>=m.preload||z(t+1,(function(){J(t+1)}))}function K(t){y-t>=m.preload||z(t-1,(function(){K(t-1)}))}function Q(t,e,n,o){t.addEventListener?t.addEventListener(e,n,o):t.attachEvent("on"+e,(function(t){(t=t||window.event).target=t.target||t.srcElement,n(t)}))}function Z(t,e,n,o){t.removeEventListener?t.removeEventListener(e,n,o):t.detachEvent("on"+e,n)}function $(t){return document.getElementById(t)}function _(t){return document.createElement(t)}return[].forEach||(Array.prototype.forEach=function(t,e){for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)}),[].filter||(Array.prototype.filter=function(t,e,n,o,i){for(n=this,o=[],i=0;i<n.length;i++)t.call(e,n[i],i,n)&&o.push(n[i]);return o}),{run:function(a,r){return function(){if(t=$("lightbox-overlay"))return e=$("lightbox-slider"),n=$("previous-button"),o=$("next-button"),void(i=$("close-button"));(t=_("div")).setAttribute("role","dialog"),t.style.cursor="-webkit-grab",t.id="lightbox-overlay",document.getElementsByTagName("body")[0].appendChild(t),(e=_("div")).id="lightbox-slider",t.appendChild(e),(n=_("button")).setAttribute("type","button"),n.id="previous-button",n.setAttribute("aria-label","Previous"),n.innerHTML=p.svg?d:"&lt;",t.appendChild(n),(o=_("button")).setAttribute("type","button"),o.id="next-button",o.setAttribute("aria-label","Next"),o.innerHTML=p.svg?f:"&gt;",t.appendChild(o),(i=_("button")).setAttribute("type","button"),i.id="close-button",i.setAttribute("aria-label","Close"),i.innerHTML=p.svg?g:"&times;",t.appendChild(i),n.className=o.className=i.className="lightbox-button",function(){var a=p.passiveEvents?{passive:!0}:null;Q(n,"click",L),Q(o,"click",A),Q(i,"click",B),Q(e,"contextmenu",I),Q(t,"mouseup",P),Q(t,"mousedown",X),Q(t,"mousemove",F),Q(t,"touchstart",S,a),Q(t,"touchmove",F,a),Q(t,"touchend",H),Q(document,"focus",Y,!0)}()}(),j(a),function(t,e){var n=document.querySelectorAll(t),o={galleries:[],nodeList:n};return E[t]=o,[].forEach.call(n,(function(t){e&&e.filter&&(C=e.filter);var n=[];if(n="A"===t.tagName?[t]:t.getElementsByTagName("a"),0!==(n=[].filter.call(n,(function(t){if(-1===t.className.indexOf(e&&e.ignoreClass))return C.test(t.href)}))).length){var i=[];[].forEach.call(n,(function(t,n){var o=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,M(i,e),O(n)},a={eventHandler:o,imageElement:t};Q(t,"click",o),i.push(a)})),o.galleries.push(i)}})),o.galleries}(a,r)},show:V,showNext:D,showPrevious:U,hide:R,destroy:function(){!function(){var a=p.passiveEvents?{passive:!0}:null;Z(n,"click",L),Z(o,"click",A),Z(i,"click",B),Z(e,"contextmenu",I),Z(t,"touchstart",S,a),Z(t,"touchmove",touchmoveHandler,a),Z(t,"touchend",H),Z(document,"focus",Y,!0)}(),function(){for(var t in E)E.hasOwnProperty(t)&&j(t)}(),Z(document,"keydown",q),document.getElementsByTagName("body")[0].removeChild(document.getElementById("lightbox-overlay")),E={},v=[],y=0}}}));
